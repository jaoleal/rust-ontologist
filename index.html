<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="cytoscape.min.js"></script>
    <script src="cytoscape-node-html-label.min.js"></script>

    <script src="https://unpkg.com/klayjs@0.4.1/klay.js"></script>
    <script src="cytoscape-klay.js"></script>

    <!-- <script src="https://unpkg.com/layout-base/layout-base.js"></script>
    <script src="https://unpkg.com/cose-base/cose-base.js"></script>
    <script src="https://unpkg.com/cytoscape-layout-utilities/cytoscape-layout-utilities.js"></script>
    <script src="cytoscape-fcose.js"></script> -->

    <link href="cytoscape.js-navigator.css" rel="stylesheet" type="text/css" />
    <script src="cytoscape-navigator.js"></script>
</head>
<style>
    #cy {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0px;
        left: 0px;
    }

    .node-label {
        color: red;
        font-family: "monospace";
    }
</style>

<body>
    <div id="cy"></div>
    <script type="module">
        fetch("codebase-dump.json", { cache: "no-store" })
            .then((response) => response.json())
            .then((graph) => {
                var cy = cytoscape({
                    container: document.getElementById("cy"),
                    elements: graph,
                    wheelSensitivity: 0.1,
                    layout: {
                        name: "klay",
                        avoidOverlap: true,
                        nodeDimensionsIncludeLabels: true
                    },
                    style: [
                        {
                            selector: "node",
                            style: {
                                "label": "data(name)",
                                "font-family": "monospace"
                            }
                        },
                        {
                            selector: ".vertex-package",
                            style: {
                                "font-size": "24px"
                            }
                        },
                        {
                            selector: ".vertex-non-package",
                            style: {
                                "min-zoomed-font-size": "18px"
                            }
                        },
                        {
                            selector: "edge",
                            style: {
                                "curve-style": "unbundled-bezier",
                                "line-cap": "round",
                                "target-arrow-shape": "triangle",
                            }
                        },
                        {
                            selector: ".edge-red",
                            style: {
                                "line-color": "#9B2335",
                                "target-arrow-color": "#9B2335"
                            }
                        },
                        {
                            selector: ".edge-blue",
                            style: {
                                "line-color": "#34568B",
                                "target-arrow-color": "#34568B"
                            }
                        },
                        {
                            selector: ".edge-green",
                            style: {
                                "line-color": "#2E8B57",
                                "target-arrow-color": "#2E8B57"
                            }
                        },
                        {
                            selector: ".edge-violet",
                            style: {
                                "line-color": "#6B5B95",
                                "target-arrow-color": "#6B5B95"
                            }
                        },
                        {
                            selector: ".edge-orange",
                            style: {
                                "line-color": "#DD6E0F",
                                "target-arrow-color": "#DD6E0F"
                            }
                        },
                        {
                            selector: ".edge-purple",
                            style: {
                                "line-color": "#663399",
                                "target-arrow-color": "#663399"
                            }
                        },
                        {
                            selector: ".edge-plum",
                            style: {
                                "line-color": "#DDA0DD",
                                "target-arrow-color": "#DDA0DD"
                            }
                        }
                    ]
                });

                var nav = cy.navigator({});

                // cy.nodeHtmlLabel([{
                //     query: ".l",
                //     valign: "top",
                //     halign: "center",
                //     valignBox: "top",
                //     halignBox: "center",
                //     tpl: function (data) {
                //         return "<span class='node-label'>" + data.id + "</span>";
                //     }
                // }]);
            });
    </script>
</body>

</html>